import{a as N}from"./chunk-VVPL7R4U.js";import{a as X,b as Y,c as et,d as it,e as nt,f as ot,g as rt,h as st}from"./chunk-YETLETR5.js";import{a as Z,b as tt}from"./chunk-ITRDAWRK.js";import{a as V,b as g,d as j,e as q,f as I,h as x,i as D,j as G,k as U,m as $,n as A,o as R,p as z,t as J,u as K,v as Q,w as W}from"./chunk-REZEDRSE.js";import{Y as B,_ as H,o as F}from"./chunk-MRS5Q2JX.js";import{Ab as l,Ib as a,Jb as v,Kb as E,S as w,Ta as c,Ua as M,_ as C,ia as O,ja as b,jb as u,lb as d,qa as S,ra as P,ub as s,vb as r,w as f,wb as _,wc as k,xb as y,xc as L,zb as h,zc as T}from"./chunk-GRSPFHKH.js";function lt(n,o){if(n&1){let m=y();s(0,"form",2),h("ngSubmit",function(){S(m);let t=l();return P(t.createPost(t.addForm.value))}),s(1,"mat-form-field",8)(2,"mat-label"),a(3,"Title"),r(),_(4,"input",9),r(),s(5,"div",10)(6,"mat-form-field",8)(7,"mat-label"),a(8,"ID"),r(),_(9,"input",11),r(),s(10,"mat-form-field",8)(11,"mat-label"),a(12,"User ID"),r(),_(13,"input",12),r()(),s(14,"mat-form-field",8)(15,"mat-label"),a(16,"Textarea"),r(),_(17,"textarea",13),r(),s(18,"button",14),a(19," Create "),r()()}if(n&2){let m=l();d("formGroup",m.addForm),c(18),d("disabled",!m.addForm.valid)}}function pt(n,o){if(n&1&&(s(0,"div",22)(1,"p"),a(2," Name: "),s(3,"span",23)(4,"strong"),a(5),r()()(),s(6,"p"),a(7),r(),s(8,"p"),a(9),r()()),n&2){let m=l().$implicit;c(5),v(m.name),c(2),E("Email: ",m.email,""),c(2),E("Text: ",m.body,"")}}function dt(n,o){if(n&1&&(s(0,"div"),u(1,pt,10,3,"div",21),r()),n&2){let m=o.$implicit,i=l(4).$implicit;c(),d("ngIf",i.id==m.post_id)}}function ut(n,o){if(n&1&&(s(0,"div"),u(1,dt,2,1,"div",16),r()),n&2){let m=l(4);c(),d("ngForOf",m.comments)}}function ft(n,o){if(n&1){let m=y();s(0,"div")(1,"div")(2,"h2"),a(3),r(),s(4,"h3"),a(5),r(),s(6,"p"),a(7),r()(),s(8,"div",18)(9,"button",19),h("click",function(){S(m);let t=l(2).index,e=l();return P(e.toggleComments(t))}),a(10," Show Comments "),r(),s(11,"button",20),h("click",function(){S(m);let t=l(2).$implicit,e=l();return P(e.deletePost(t))}),a(12," Delete "),r()(),u(13,ut,2,1,"div",17),r()}if(n&2){let m=l().$implicit,i=l(),t=i.$implicit,e=i.index,p=l();c(3),v(m.name),c(2),v(t.title),c(2),v(t.body),c(2),d("disabled",!p.checkIfHasComment(t.id)),c(4),d("ngIf",p.showComments[e])}}function _t(n,o){if(n&1&&(s(0,"div"),u(1,ft,14,5,"div",17),r()),n&2){let m=o.$implicit,i=l().$implicit;c(),d("ngIf",i.user_id==m.id)}}function ht(n,o){if(n&1&&(s(0,"div",15),u(1,_t,2,1,"div",16),r()),n&2){let m=l();c(),d("ngForOf",m.users)}}var at=(()=>{let o=class o{constructor(i,t,e){this.postService=i,this.commentService=t,this.userService=e,this.posts=[],this.comments=[],this.users=[],this.showComments=[],this.showForm=!1}ngOnInit(){this.userService.getUsers(10).pipe(w(i=>{this.users=i;let t=this.users.map(e=>this.postService.getUserPost(e.id));return f(t)}),w(i=>{this.posts=i.flatMap(e=>e);let t=this.posts.map(e=>this.commentService.getComment(e.id));return f(t)})).subscribe(i=>{this.comments=i.flatMap(t=>t)}),this.addForm=new I({title:new x("",g.required),body:new x("",g.required),id:new x("",g.required),user_id:new x("",g.required)}),this.searchForm=new I({searchValue:new x("")})}checkIfHasComment(i){return!!this.comments.some(e=>e.post_id==i)}toggleComments(i){this.showComments[i]=!this.showComments[i]}showAddForm(){this.showForm=!this.showForm}createPost(i){try{this.postService.addPost(i).subscribe(()=>{let t=this.users.map(e=>this.postService.getUserPost(e.id));f(t).subscribe(e=>{this.posts=e.flatMap(p=>p),this.addForm.reset(),this.showAddForm()})})}catch(t){alert(t)}}searchPost(i){this.postService.searchPost(i).subscribe(()=>{let t=this.users.map(e=>this.postService.getUserPost(e.id));f(t).subscribe(e=>{this.posts=e.flatMap(p=>p),this.posts=this.posts.filter(p=>p.title.toLowerCase().includes(i.toLowerCase()))})})}deletePost(i){confirm("Are you sure to delete the post?")&&this.postService.deleteUserPost(i).subscribe(()=>{let t=this.users.map(e=>this.postService.getUserPost(e.id));f(t).subscribe(e=>{this.posts=e.flatMap(p=>p)})})}};o.\u0275fac=function(t){return new(t||o)(M(Y),M(st),M(X))},o.\u0275cmp=O({type:o,selectors:[["app-post-list"]],decls:19,vars:3,consts:[[1,"container"],[1,"modify-section"],[3,"ngSubmit","formGroup"],["matInput","","type","text","name","searchValue","formControlName","searchValue"],["mat-flat-button","","color","primary",3,"click"],[1,"form-section"],[3,"formGroup","ngSubmit",4,"ngIf"],["class","post-block",4,"ngFor","ngForOf"],["appearance","fill",1,"input-field"],["matInput","","name","title","formControlName","title"],[1,"id"],["matInput","","name","id","formControlName","id","minlength","6","maxlength","6"],["matInput","","name","user_id","formControlName","user_id","minlength","7","maxlength","7"],["matInput","","name","body","formControlName","body"],["mat-flat-button","","color","primary","type","submit",1,"submitBtn",3,"disabled"],[1,"post-block"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"button-section"],["mat-button","","color","primary",1,"showBtn",3,"click","disabled"],["mat-button","","color","warn",3,"click"],["class","comment-container",4,"ngIf"],[1,"comment-container"],[1,"comment-name"]],template:function(t,e){t&1&&(s(0,"div",0)(1,"div",1)(2,"form",2),h("ngSubmit",function(){return e.searchPost(e.searchForm.value.searchValue)}),s(3,"mat-expansion-panel")(4,"mat-expansion-panel-header")(5,"mat-panel-title"),a(6," Search "),r(),s(7,"mat-panel-description")(8,"mat-icon"),a(9,"account_circle"),r()()(),s(10,"mat-form-field")(11,"mat-label"),a(12,"Title"),r(),_(13,"input",3),r()()(),s(14,"button",4),h("click",function(){return e.showAddForm()}),a(15," Add Post "),r()(),s(16,"div",5),u(17,lt,20,2,"form",6),r(),u(18,ht,2,1,"div",7),r()),t&2&&(c(2),d("formGroup",e.searchForm),c(15),d("ngIf",e.showForm),c(),d("ngForOf",e.posts))},dependencies:[k,L,B,D,V,j,q,$,A,G,U,J,z,Q,et,it,ot,nt,Z],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding-bottom:10px}.modify-section[_ngcontent-%COMP%]{margin-top:15px;width:60%;display:flex;flex-direction:row;justify-content:space-between}.form-section[_ngcontent-%COMP%]{margin-top:10px}.input-field[_ngcontent-%COMP%]{width:100%}.id[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:space-between}.post-block[_ngcontent-%COMP%]{width:60%;padding:15px;margin-top:10px;background-color:#f7fafc}.post-block[_ngcontent-%COMP%]:hover{background-color:#e2e2e2}.button-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.comment-container[_ngcontent-%COMP%]{margin-top:10px;padding:10px;display:flex;flex-direction:column}.comment-container[_ngcontent-%COMP%]:hover{background-color:#f0efef}.comment-container[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{margin:3px}.comment-name[_ngcontent-%COMP%]{font-size:15px}"]});let n=o;return n})();var xt=[{path:"",component:at,canActivate:[N]}],ct=(()=>{let o=class o{};o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=b({type:o}),o.\u0275inj=C({imports:[F.forChild(xt),F]});let n=o;return n})();var Ht=(()=>{let o=class o{};o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=b({type:o}),o.\u0275inj=C({imports:[T,H,R,K,W,rt,tt,ct]});let n=o;return n})();export{Ht as PostModule};
